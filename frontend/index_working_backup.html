<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget Master</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        .login-form {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            max-width: 400px;
            width: 100%;
        }
        input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
        }
        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            margin: 10px 0;
        }
        .app-container {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            color: white;
            text-align: center;
            margin-bottom: 30px;
        }
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .category-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .progress-bar {
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="login-container" id="authContainer">
        <div class="login-form">
            <h2>üí∞ Budget Master</h2>
            <p>Track your expenses smartly</p>
            <input type="email" placeholder="Email" id="email">
            <input type="password" placeholder="Password" id="password">
            <button onclick="showDashboard()">Login</button>
        </div>
    </div>

    <div class="app-container" id="mainApp">
        <div class="header">
            <h1>üí∞ Budget Master Dashboard</h1>
            <button onclick="showLogin()" style="width: auto; padding: 10px 20px; margin: 10px;">Logout</button>
        </div>
        
        <div style="background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px; text-align: center;">
            <h2 style="color: #2ecc71;">$1,250.75</h2>
            <p>Available for Savings This Month</p>
        </div>

        <div class="categories-grid">
            <div class="category-card">
                <h3>üõí Groceries</h3>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 71%; background: #27ae60;"></div>
                </div>
                <p>Spent: $285.50 / Budget: $400</p>
                <input type="number" placeholder="Add amount" style="width: 60%; display: inline-block;">
                <button style="width: 35%; display: inline-block; margin-left: 5%;" onclick="alert('Added to Groceries!')">Add</button>
            </div>

            <div class="category-card">
                <h3>üçï Outside Food</h3>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 78%; background: #e74c3c;"></div>
                </div>
                <p>Spent: $156.25 / Budget: $200</p>
                <input type="number" placeholder="Add amount" style="width: 60%; display: inline-block;">
                <button style="width: 35%; display: inline-block; margin-left: 5%;" onclick="alert('Added to Food!')">Add</button>
            </div>

            <div class="category-card">
                <h3>‚õΩ Gas</h3>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 36%; background: #f39c12;"></div>
                </div>
                <p>Spent: $89.00 / Budget: $250</p>
                <input type="number" placeholder="Add amount" style="width: 60%; display: inline-block;">
                <button style="width: 35%; display: inline-block; margin-left: 5%;" onclick="alert('Added to Gas!')">Add</button>
            </div>

            <div class="category-card">
                <h3>üè† Rent</h3>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%; background: #3498db;"></div>
                </div>
                <p>Spent: $1200 / Budget: $1200</p>
                <input type="number" placeholder="Add amount" style="width: 60%; display: inline-block;">
                <button style="width: 35%; display: inline-block; margin-left: 5%;" onclick="alert('Added to Rent!')">Add</button>
            </div>

            <div class="category-card">
                <h3>ü§ù Lent Money</h3>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 50%; background: #9b59b6;"></div>
                </div>
                <p>Spent: $75.00 / Budget: $150</p>
                <input type="number" placeholder="Add amount" style="width: 60%; display: inline-block;">
                <button style="width: 35%; display: inline-block; margin-left: 5%;" onclick="alert('Added to Lent Money!')">Add</button>
            </div>

            <div class="category-card">
                <h3>üí≥ Additional Expenses</h3>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%; background: #e74c3c;"></div>
                </div>
                <p style="color: #e74c3c;"><strong>Spent: $340.75 / Budget: $300 (OVER BUDGET!)</strong></p>
                <input type="number" placeholder="Add amount" style="width: 60%; display: inline-block;">
                <button style="width: 35%; display: inline-block; margin-left: 5%;" onclick="alert('Added to Additional!')">Add</button>
            </div>
        </div>
    </div>

    <script>
        function showDashboard() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
        }
        
        function showLogin() {
            document.getElementById('authContainer').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
        }
    </script>
</body>
</html>

<script>
// Real Backend Integration
const API_BASE_URL = 'http://localhost:8000/api';
let currentUser = null;

// Replace the showDashboard function with real login
async function showDashboard() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    
    if (!email || !password) {
        // Demo mode if no credentials
        document.getElementById('authContainer').style.display = 'none';
        document.getElementById('mainApp').style.display = 'block';
        return;
    }
    
    try {
        // Try real login first
        const response = await fetch(API_BASE_URL + '/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, password })
        });
        
        if (response.ok) {
            const data = await response.json();
            currentUser = { id: data.user_id, name: data.name, email: data.email };
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            alert('‚úÖ Connected to real database! User: ' + data.name);
            loadUserData();
        } else {
            // Try registration if login fails
            const regResponse = await fetch(API_BASE_URL + '/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    email, 
                    password, 
                    name: 'New User',
                    monthly_savings_target: 1000
                })
            });
            
            if (regResponse.ok) {
                const regData = await regResponse.json();
                alert('‚úÖ New account created! Please login again.');
            } else {
                alert('‚ùå Login failed. Using demo mode.');
                document.getElementById('authContainer').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
            }
        }
    } catch (error) {
        alert('‚ùå Backend not connected. Using demo mode.');
        document.getElementById('authContainer').style.display = 'none';
        document.getElementById('mainApp').style.display = 'block';
    }
}

// Load user's real budget data
async function loadUserData() {
    if (!currentUser) return;
    
    try {
        const response = await fetch(API_BASE_URL + `/budget-status/${currentUser.id}`);
        if (response.ok) {
            const budgetData = await response.json();
            alert('‚úÖ Loaded your real budget data from database!');
            // We'll update the UI with real data in next step
        }
    } catch (error) {
        console.log('Using demo data');
    }
}
</script>


<script>
const API_BASE_URL = 'http://localhost:8000/api';
let currentUser = null;

async function showDashboard() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    
    if (!email || !password) {
        document.getElementById('authContainer').style.display = 'none';
        document.getElementById('mainApp').style.display = 'block';
        return;
    }
    
    try {
        const response = await fetch(API_BASE_URL + '/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, password })
        });
        
        if (response.ok) {
            const data = await response.json();
            currentUser = { id: data.user_id, name: data.name, email: data.email };
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            alert('Connected to real database! User: ' + data.name);
        } else {
            const regResponse = await fetch(API_BASE_URL + '/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    email: email, 
                    password: password, 
                    name: 'New User',
                    monthly_savings_target: 1000
                })
            });
            
            if (regResponse.ok) {
                alert('New account created! Please login again.');
            } else {
                alert('Login failed. Using demo mode.');
                document.getElementById('authContainer').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
            }
        }
    } catch (error) {
        alert('Backend not connected. Using demo mode.');
        document.getElementById('authContainer').style.display = 'none';
        document.getElementById('mainApp').style.display = 'block';
    }
}
</script>


<script>
async function addRealExpense(categoryName, categoryId) {
    if (!currentUser) {
        alert('Please login first');
        return;
    }
    
    const amountInput = document.querySelector(`input[placeholder="Add amount"]`);
    const amount = parseFloat(prompt('Enter amount for ' + categoryName + ':'));
    
    if (!amount || amount <= 0) {
        alert('Please enter a valid amount');
        return;
    }
    
    try {
        const response = await fetch(API_BASE_URL + '/expenses', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                user_id: currentUser.id,
                category_id: categoryId,
                amount: amount,
                description: 'Added via app'
            })
        });
        
        if (response.ok) {
            alert('üí∞ $' + amount.toFixed(2) + ' added to ' + categoryName + ' and saved to database!');
            loadRealBudgetData();
        } else {
            alert('Failed to save expense');
        }
    } catch (error) {
        alert('Error saving expense: ' + error.message);
    }
}

async function loadRealBudgetData() {
    if (!currentUser) return;
    
    try {
        const response = await fetch(API_BASE_URL + `/budget-status/${currentUser.id}`);
        if (response.ok) {
            const budgetData = await response.json();
            alert('üìä Budget data updated from database!');
            console.log('Real budget data:', budgetData);
        }
    } catch (error) {
        console.log('Using demo data');
    }
}
</script>

